"use strict";(self.webpackChunkmiuform=self.webpackChunkmiuform||[]).push([[546],{1546:(Q,h,n)=>{n.r(h),n.d(h,{ReportsModule:()=>Y});var s=n(6895),c=n(9132),i=n(590),a=n(4004),f=n(5577),t=n(4650),d=n(8920),R=n(4859),v=n(7392),m=n(4633),l=n(3238),T=n(4385),Z=n(1576),g=n(4463);function A(o,r){if(1&o&&(t.TgZ(0,"mat-option",7),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function C(o,r){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"p",8)(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA()()()),2&o){const e=r.$implicit;t.xp6(3),t.hij(" ",e.content," "),t.xp6(2),t.hij(" ",e.isChecked," ")}}function y(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"p"),t._uU(2),t.qZA(),t.TgZ(3,"div",1)(4,"div",2)(5,"mat-select",3),t.ALo(6,"translate"),t.YNc(7,A,2,2,"mat-option",4),t.qZA()(),t.TgZ(8,"mat-list"),t.YNc(9,C,6,2,"mat-list-item",5),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.generateReport())}),t.TgZ(11,"mat-icon"),t._uU(12,"rebase_edit"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Oqu(e.report._id),t.xp6(3),t.s9C("placeholder",t.lcZ(6,4,"REPORTS.FILTER_BY_FACTORIES")),t.xp6(2),t.Q6J("ngForOf",e.factoryItems),t.xp6(2),t.Q6J("ngForOf",e.report.checklist)}}function F(o,r){1&o&&(t.TgZ(0,"div")(1,"p"),t._uU(2,"Raport nie istnieje."),t.qZA()())}let O=(()=>{class o{constructor(e,p,u){this.logger=e,this.activatedRoute=p,this.reportService=u,this.report=void 0,this.factoryItems=[]}ngOnInit(){this.activatedRoute.params.pipe((0,i.P)(),(0,a.U)(e=>e.id),(0,f.z)(e=>(this.logger.debug(`prepare report for id: ${e}`),void 0!==e&&""!==e?this.reportService.getReport(e):this.reportService.createNewReport())),(0,i.P)(),(0,f.z)(e=>(this.report=e,this.reportService.getFactories(!1))),(0,i.P)(),(0,a.U)(e=>this.factoryItems=e)).subscribe()}generateReport(){this.reportService.generateAndSaveReport(this.report).pipe((0,i.P)(),(0,a.U)(e=>e)).subscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.Yd),t.Y36(c.gz),t.Y36(d.rM))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-prepare-report"]],decls:5,vars:5,consts:[[4,"ngIf"],["fxLayout","column"],["fxLayout","row"],["multiple","",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["mat-fab","","color","primary",1,"mat-fab-bottom-right",3,"click"],[3,"value"],["matLine",""]],template:function(e,p){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.YNc(3,y,13,6,"div",0),t.YNc(4,F,3,0,"div",0)),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,3,"PREPARE_REPORT.TITLE")),t.xp6(2),t.Q6J("ngIf",p.report),t.xp6(1),t.Q6J("ngIf",!p.report))},dependencies:[s.sg,s.O5,R.lW,v.Hw,m.i$,m.Tg,l.X2,T.gD,l.ey,Z.xw,g.X$]}),o})(),P=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-preview-report"]],decls:5,vars:3,template:function(e,p){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"p"),t._uU(4,"preview-report works!"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PREVIEW_REPORT.TITLE")))},dependencies:[g.X$]}),o})();var x=n(8505),I=n(6709);function E(o,r){if(1&o&&(t.TgZ(0,"mat-option",7),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function U(o,r){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"p",8)(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA()()()),2&o){const e=r.$implicit;t.xp6(3),t.hij(" ",e.dateOfCreation," "),t.xp6(2),t.hij(" ",null==e.factoryInfo?null:e.factoryInfo.shortName," ")}}const L=function(){return["prepare"]},S=[{path:"",component:(()=>{class o{constructor(e){this.reportService=e,this.loadFactoryWithNoActive=!1,this.factoryItems=[],this.items=[]}ngOnInit(){this.reloadFactories(this.loadFactoryWithNoActive).pipe((0,f.z)(e=>this.reloadReports()),(0,i.P)()).subscribe()}reloadReports(){return this.reportService.getReports(!0).pipe((0,x.b)(e=>this.items=e),(0,a.U)(e=>!0))}reloadFactories(e){return this.reportService.getFactories(e).pipe((0,x.b)(p=>this.factoryItems=p),(0,a.U)(p=>!0))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.rM))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-reports"]],decls:15,vars:11,consts:[["fxLayout","column"],["fxLayout","row"],["multiple","",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"checked","change"],[4,"ngFor","ngForOf"],["mat-fab","","color","primary",1,"mat-fab-bottom-right",3,"routerLink"],[3,"value"],["matLine",""]],template:function(e,p){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"{{ 'REPORTS.TITLE' | translate }"),t.qZA(),t.TgZ(3,"div",1)(4,"mat-select",2),t.ALo(5,"translate"),t.YNc(6,E,2,2,"mat-option",3),t.qZA(),t.TgZ(7,"mat-checkbox",4),t.NdJ("change",function(M){return p.reloadFactories(M.checked)}),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"mat-list"),t.YNc(11,U,6,2,"mat-list-item",5),t.qZA(),t.TgZ(12,"button",6)(13,"mat-icon"),t._uU(14,"add"),t.qZA()()()),2&e&&(t.xp6(4),t.s9C("placeholder",t.lcZ(5,6,"REPORTS.FILTER_BY_FACTORIES")),t.xp6(2),t.Q6J("ngForOf",p.factoryItems),t.xp6(1),t.Q6J("checked",p.loadFactoryWithNoActive),t.xp6(1),t.hij(" ",t.lcZ(9,8,"REPORTS.LOAD_NOACTIVE_FACTORIES")," "),t.xp6(3),t.Q6J("ngForOf",p.items),t.xp6(1),t.Q6J("routerLink",t.DdM(10,L)))},dependencies:[s.sg,c.rH,R.lW,I.oG,v.Hw,m.i$,m.Tg,l.X2,T.gD,l.ey,Z.xw,g.X$]}),o})()},{path:"prepare",component:O},{path:"preview/:id",component:P}];let J=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.Bz.forChild(S),c.Bz]}),o})();var N=n(2796);let Y=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[s.ez,J,N.m]}),o})()}}]);