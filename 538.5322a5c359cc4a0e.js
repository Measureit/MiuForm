"use strict";(self.webpackChunkmiuform=self.webpackChunkmiuform||[]).push([[538],{4538:(z,N,a)=>{a.r(N),a.d(N,{ConfigurationModule:()=>E});var h=a(6895),x=a(9132),t=a(4650),b=a(3848),f=a(8505),m=a(590),y=a(5577),r=(()=>{return(n=r||(r={}))[n.Create=0]="Create",n[n.Update=1]="Update",n[n.Delete=2]="Delete",r;var n})(),J=a(8897),q=a(1042);class _ extends J.j{constructor(){super(...arguments),this.emails=[]}static Create(){let i=new _;return i._id=`factory_${q.Z()}`,i.isActive=!0,i}}var v=a(8920),l=a(7274),U=a(9521),p=a(4006),M=a(4859),g=a(7331),L=a(7392),k=a(4144),R=a(9549),F=a(4463);function S(n,i){1&n&&(t.TgZ(0,"h1",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CONFIGURATION.FACTORIES.EDITOR.CREATE")))}function Y(n,i){1&n&&(t.TgZ(0,"h1",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CONFIGURATION.FACTORIES.EDITOR.UPDATE")))}function D(n,i){1&n&&(t.TgZ(0,"h1",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CONFIGURATION.FACTORIES.EDITOR.REMOVE")))}function Q(n,i){1&n&&(t.TgZ(0,"mat-icon",13),t._uU(1,"cancel"),t.qZA())}function G(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"mat-chip-row",11),t.NdJ("removed",function(){const c=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.removeEmail(c))}),t._uU(1),t.YNc(2,Q,2,0,"mat-icon",12),t.qZA()}if(2&n){const e=i.$implicit,o=t.oxw();t.Q6J("color",e?"warn":"")("removable",o.removable),t.xp6(1),t.hij(" ",e," "),t.xp6(1),t.Q6J("ngIf",o.removable)}}function $(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.addOrUpdate(s.item))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"COMMON.CREATE")))}function w(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.addOrUpdate(s.item))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"COMMON.UPDATE")))}function H(n,i){1&n&&(t.TgZ(0,"button",15),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"COMMON.REMOVE")))}class C{constructor(i,e,o){this.configurationService=i,this.dialogRef=e,this.data=o,this.EditorActions=r,this.separatorKeysCodes=[U.K5,U.OC],this.removable=!0,this.fb=new p.qu,this.item=o.item,this.item.emails||(this.item.emails=[])}onNoClick(){this.dialogRef.close(!1)}addOrUpdate(i){this.configurationService.addOrUpdateFactory(i).pipe((0,m.P)(),(0,f.b)(e=>this.dialogRef.close(!0))).subscribe()}addEmail(i){console.log(i.value),i.value&&(this.validateEmail(i.value)?(this.item.emails.push(i.value),i.input&&(i.input.value="")):console.error("wrong email..."))}removeEmail(i){console.log("Removing "+i),this.item.emails.indexOf(i)>=0&&this.item.emails.splice(this.item.emails.indexOf(i),1)}validateEmail(i){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(i).toLowerCase())}static#t=this.\u0275fac=function(e){return new(e||C)(t.Y36(v.eB),t.Y36(l.so),t.Y36(l.WI))};static#e=this.\u0275cmp=t.Xpm({type:C,selectors:[["app-editor"]],decls:31,vars:25,consts:[["mat-dialog-title","",4,"ngIf"],["appearance","fill"],["matInput","",3,"ngModel","ngModelChange"],["formArrayName","emails"],["chipList",""],["selected","","required","","name","chips",3,"color","removable","removed",4,"ngFor","ngForOf"],["placeholder","enter item ",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click",4,"ngIf"],["mat-button","","cdkFocusInitial","",4,"ngIf"],["mat-dialog-title",""],["selected","","required","","name","chips",3,"color","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["mat-button","","cdkFocusInitial","",3,"click"],["mat-button","","cdkFocusInitial",""]],template:function(e,o){if(1&e&&(t.YNc(0,S,3,3,"h1",0),t.YNc(1,Y,3,3,"h1",0),t.YNc(2,D,3,3,"h1",0),t.TgZ(3,"mat-dialog-content")(4,"mat-form-field",1)(5,"mat-label"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"input",2),t.NdJ("ngModelChange",function(c){return o.item.name=c}),t.qZA()(),t.TgZ(9,"mat-form-field",1)(10,"mat-label"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"input",2),t.NdJ("ngModelChange",function(c){return o.item.shortName=c}),t.qZA()(),t.TgZ(14,"mat-form-field",1)(15,"mat-label"),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"input",2),t.NdJ("ngModelChange",function(c){return o.item.address=c}),t.qZA()(),t.TgZ(19,"mat-form-field",1)(20,"mat-chip-grid",3,4),t.YNc(22,G,3,4,"mat-chip-row",5),t.qZA(),t.TgZ(23,"input",6),t.NdJ("matChipInputTokenEnd",function(c){return o.addEmail(c)}),t.qZA()()(),t.TgZ(24,"mat-dialog-actions")(25,"button",7),t.NdJ("click",function(){return o.onNoClick()}),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.YNc(28,$,3,3,"button",8),t.YNc(29,w,3,3,"button",8),t.YNc(30,H,3,3,"button",9),t.qZA()),2&e){const s=t.MAs(21);t.Q6J("ngIf",o.data.action===o.EditorActions.Create),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Update),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Delete),t.xp6(4),t.Oqu(t.lcZ(7,17,"ITEM.FACTORY.NAME")),t.xp6(2),t.Q6J("ngModel",o.item.name),t.xp6(3),t.Oqu(t.lcZ(12,19,"ITEM.FACTORY.SHORTNAME")),t.xp6(2),t.Q6J("ngModel",o.item.shortName),t.xp6(3),t.Oqu(t.lcZ(17,21,"ITEM.FACTORY.ADDRESS")),t.xp6(2),t.Q6J("ngModel",o.item.address),t.xp6(4),t.Q6J("ngForOf",o.item.emails),t.xp6(1),t.Q6J("matChipInputFor",s)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes)("matChipInputAddOnBlur",!0),t.xp6(3),t.Oqu(t.lcZ(27,23,"COMMON.CANCEL")),t.xp6(2),t.Q6J("ngIf",o.data.action===o.EditorActions.Create),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Update),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Delete)}},dependencies:[h.sg,h.O5,M.lW,g.RA,g.oH,g.qH,g.z3,l.uh,l.xY,l.H8,L.Hw,k.Nt,R.KE,R.hX,p.Fj,p.JJ,p.JL,p.On,F.X$],styles:["mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}mat-dialog-actions[_ngcontent-%COMP%]{justify-content:end}"]})}var K=a(6709),d=a(4633);function P(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"mat-list-item",5),t.NdJ("click",function(){const c=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.updateItem(c._id))}),t.TgZ(1,"span",6),t._uU(2),t.qZA(),t.TgZ(3,"span",7),t._uU(4),t.qZA(),t.TgZ(5,"span",7),t._uU(6),t.qZA(),t.TgZ(7,"button",8),t.NdJ("click",function(){const c=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.deleteItem(c._id))}),t.TgZ(8,"mat-icon"),t._uU(9,"delete"),t.qZA()()()}if(2&n){const e=i.$implicit;t.xp6(2),t.AsE("",e.shortName," -> ",e.name,""),t.xp6(2),t.Oqu(e.address),t.xp6(2),t.Oqu(e.emails?e.emails.join(", "):"")}}class T{constructor(i,e,o){this.logger=i,this.configurationService=e,this.dialog=o,this.loadFactoryWithNoActive=!1,this.items=[]}ngOnInit(){this.reloadFactories(this.loadFactoryWithNoActive)}reloadFactories(i){this.configurationService.getFactories(i).pipe((0,f.b)(e=>this.items=e),(0,m.P)()).subscribe()}displayEditor(i,e){return this.dialog.open(C,{width:"90%",data:{item:i,action:e}}).afterClosed().pipe((0,m.P)(),(0,f.b)(o=>this.logger.debug(`The dialog was closed with result ${o}, action ${e}`)),(0,f.b)(o=>{!0===o&&this.reloadFactories(this.loadFactoryWithNoActive)}))}addItem(){this.displayEditor(_.Create(),r.Create).subscribe({next:i=>{},error:i=>{}})}updateItem(i){this.configurationService.getFactory(i).pipe((0,m.P)(),(0,y.z)(o=>this.displayEditor(o,r.Update))).subscribe({next:o=>{},error:o=>{}})}deleteItem(i){console.log("delete factory"),this.configurationService.getFactory(i).pipe((0,m.P)(),(0,y.z)(o=>this.displayEditor(o,r.Delete))).subscribe({next:o=>{},error:o=>{}})}static#t=this.\u0275fac=function(e){return new(e||T)(t.Y36(v.Yd),t.Y36(v.eB),t.Y36(l.uw))};static#e=this.\u0275cmp=t.Xpm({type:T,selectors:[["app-factories"]],decls:10,vars:5,consts:[["fxLayout","column"],["fxLayout","row"],[3,"checked","change"],[3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","primary",1,"mat-fab-bottom-right",3,"click"],[3,"click"],["matListItemTitle",""],["matListItemLine",""],["matListItemMeta","",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-checkbox",2),t.NdJ("change",function(c){return o.reloadFactories(c.checked)}),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"mat-list"),t.YNc(6,P,10,4,"mat-list-item",3),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return o.addItem()}),t.TgZ(8,"mat-icon"),t._uU(9,"add"),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("checked",o.loadFactoryWithNoActive),t.xp6(1),t.hij(" ",t.lcZ(4,3,"CONFIGURATION.FACTORIES.LOAD_NOACTIVE")," "),t.xp6(3),t.Q6J("ngForOf",o.items))},dependencies:[h.sg,M.cs,K.oG,L.Hw,d.i$,d.Tg,d.WW,d.sL,d.ni,F.X$]})}class A{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(e){return new(e||A)};static#e=this.\u0275cmp=t.Xpm({type:A,selectors:[["app-checklist"]],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"checklist works!"),t.qZA())}})}class Z{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(e){return new(e||Z)};static#e=this.\u0275cmp=t.Xpm({type:Z,selectors:[["app-delivery"]],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"delivery works!"),t.qZA())}})}class O{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(e){return new(e||O)};static#e=this.\u0275cmp=t.Xpm({type:O,selectors:[["app-configuration"]],decls:13,vars:12,consts:[[3,"label"]],template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"mat-tab-group")(4,"mat-tab",0),t.ALo(5,"translate"),t._UZ(6,"app-factories"),t.qZA(),t.TgZ(7,"mat-tab",0),t.ALo(8,"translate"),t._UZ(9,"app-checklist"),t.qZA(),t.TgZ(10,"mat-tab",0),t.ALo(11,"translate"),t._UZ(12,"app-delivery"),t.qZA()()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,4,"CONFIGURATION.TITLE")),t.xp6(3),t.s9C("label",t.lcZ(5,6,"CONFIGURATION.FACTORIES.TITLE")),t.xp6(3),t.s9C("label",t.lcZ(8,8,"CONFIGURATION.CHECKLIST.TITLE")),t.xp6(3),t.s9C("label",t.lcZ(11,10,"CONFIGURATION.DELIVERY.TITLE")))},dependencies:[b.uX,b.SP,T,A,Z,F.X$]})}const X=[{path:"",component:O}];class I{static#t=this.\u0275fac=function(e){return new(e||I)};static#e=this.\u0275mod=t.oAB({type:I});static#i=this.\u0275inj=t.cJS({imports:[x.Bz.forChild(X),x.Bz]})}var j=a(1913);class E{static#t=this.\u0275fac=function(e){return new(e||E)};static#e=this.\u0275mod=t.oAB({type:E});static#i=this.\u0275inj=t.cJS({imports:[h.ez,I,j.m]})}}}]);