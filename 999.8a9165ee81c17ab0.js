"use strict";(self.webpackChunkmiuform=self.webpackChunkmiuform||[]).push([[999],{8999:(Y,g,r)=>{r.r(g),r.d(g,{ReportsModule:()=>N});var s=r(6895),c=r(9132),a=r(590),p=r(4004),f=r(5577),t=r(4650),d=r(8920),h=r(4859),R=r(7392),l=r(4633),m=r(3238),v=r(4385),T=r(1576),Z=r(4463);function A(o,n){if(1&o&&(t.TgZ(0,"mat-option",7),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function y(o,n){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"p",8)(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA()()()),2&o){const e=n.$implicit;t.xp6(3),t.hij(" ",e.content," "),t.xp6(2),t.hij(" ",e.isChecked," ")}}function C(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"p"),t._uU(2),t.qZA(),t.TgZ(3,"div",1)(4,"div",2)(5,"mat-select",3),t.ALo(6,"translate"),t.YNc(7,A,2,2,"mat-option",4),t.qZA()(),t.TgZ(8,"mat-list"),t.YNc(9,y,6,2,"mat-list-item",5),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.generateReport())}),t.TgZ(11,"mat-icon"),t._uU(12,"rebase_edit"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Oqu(e.report._id),t.xp6(3),t.s9C("placeholder",t.lcZ(6,4,"REPORTS.FILTER_BY_FACTORIES")),t.xp6(2),t.Q6J("ngForOf",e.factoryItems),t.xp6(2),t.Q6J("ngForOf",e.report.checklist)}}function F(o,n){1&o&&(t.TgZ(0,"div")(1,"p"),t._uU(2,"Raport nie istnieje."),t.qZA()())}let O=(()=>{class o{constructor(e,i,u){this.logger=e,this.activatedRoute=i,this.reportService=u,this.report=void 0,this.factoryItems=[]}ngOnInit(){this.activatedRoute.params.pipe((0,a.P)(),(0,p.U)(e=>e.id),(0,f.z)(e=>(this.logger.debug(`prepare report for id: ${e}`),void 0!==e&&""!==e?this.reportService.getReport(e):this.reportService.createNewReport())),(0,a.P)(),(0,f.z)(e=>(this.report=e,this.reportService.getFactories(!1))),(0,a.P)(),(0,p.U)(e=>this.factoryItems=e)).subscribe()}generateReport(){this.reportService.generateAndSaveReport(this.report).pipe((0,a.P)(),(0,p.U)(e=>e)).subscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.Yd),t.Y36(c.gz),t.Y36(d.rM))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-prepare-report"]],decls:5,vars:5,consts:[[4,"ngIf"],["fxLayout","column"],["fxLayout","row"],["multiple","",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["mat-fab","","color","primary",1,"mat-fab-bottom-right",3,"click"],[3,"value"],["matLine",""]],template:function(e,i){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.YNc(3,C,13,6,"div",0),t.YNc(4,F,3,0,"div",0)),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,3,"PREPARE_REPORT.TITLE")),t.xp6(2),t.Q6J("ngIf",i.report),t.xp6(1),t.Q6J("ngIf",!i.report))},dependencies:[s.sg,s.O5,h.lW,R.Hw,l.i$,l.Tg,m.X2,v.gD,m.ey,T.xw,Z.X$]}),o})();var x=r(8505),P=r(6709);function I(o,n){if(1&o&&(t.TgZ(0,"mat-option",7),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function S(o,n){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"p",8)(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA()()()),2&o){const e=n.$implicit;t.xp6(3),t.hij(" ",e.dateOfCreation," "),t.xp6(2),t.hij(" ",null==e.factoryInfo?null:e.factoryInfo.shortName," ")}}const U=function(){return["prepare"]},L=[{path:"",component:(()=>{class o{constructor(e){this.reportService=e,this.loadFactoryWithNoActive=!1,this.factoryItems=[],this.items=[]}ngOnInit(){this.reloadFactories(this.loadFactoryWithNoActive).pipe((0,f.z)(e=>this.reloadReports()),(0,a.P)()).subscribe()}reloadReports(){return this.reportService.getReports(!0).pipe((0,x.b)(e=>this.items=e),(0,p.U)(e=>!0))}reloadFactories(e){return this.reportService.getFactories(e).pipe((0,x.b)(i=>this.factoryItems=i),(0,p.U)(i=>!0))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.rM))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-reports"]],decls:15,vars:11,consts:[["fxLayout","column"],["fxLayout","row"],["multiple","",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"checked","change"],[4,"ngFor","ngForOf"],["mat-fab","","color","primary",1,"mat-fab-bottom-right",3,"routerLink"],[3,"value"],["matLine",""]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"{{ 'REPORTS.TITLE' | translate }"),t.qZA(),t.TgZ(3,"div",1)(4,"mat-select",2),t.ALo(5,"translate"),t.YNc(6,I,2,2,"mat-option",3),t.qZA(),t.TgZ(7,"mat-checkbox",4),t.NdJ("change",function(M){return i.reloadFactories(M.checked)}),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"mat-list"),t.YNc(11,S,6,2,"mat-list-item",5),t.qZA(),t.TgZ(12,"button",6)(13,"mat-icon"),t._uU(14,"add"),t.qZA()()()),2&e&&(t.xp6(4),t.s9C("placeholder",t.lcZ(5,6,"REPORTS.FILTER_BY_FACTORIES")),t.xp6(2),t.Q6J("ngForOf",i.factoryItems),t.xp6(1),t.Q6J("checked",i.loadFactoryWithNoActive),t.xp6(1),t.hij(" ",t.lcZ(9,8,"REPORTS.LOAD_NOACTIVE_FACTORIES")," "),t.xp6(3),t.Q6J("ngForOf",i.items),t.xp6(1),t.Q6J("routerLink",t.DdM(10,U)))},dependencies:[s.sg,c.rH,h.lW,P.oG,R.Hw,l.i$,l.Tg,m.X2,v.gD,m.ey,T.xw,Z.X$]}),o})()},{path:"prepare",component:O},{path:"preview",loadChildren:()=>Promise.all([r.e(592),r.e(418)]).then(r.bind(r,2418)).then(o=>o.PreviewReportModule)}];let E=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.Bz.forChild(L),c.Bz]}),o})();var J=r(2796);let N=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[s.ez,E,J.m]}),o})()}}]);