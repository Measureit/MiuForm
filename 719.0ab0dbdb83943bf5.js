"use strict";(self.webpackChunkmiuform=self.webpackChunkmiuform||[]).push([[719],{6719:(it,N,a)=>{a.r(N),a.d(N,{ConfigurationModule:()=>Z});var p=a(6895),x=a(9132),t=a(4650),b=a(3848),u=a(8505),m=a(590),y=a(5577),l=(()=>{return(n=l||(l={}))[n.Create=0]="Create",n[n.Update=1]="Update",n[n.Delete=2]="Delete",l;var n})(),J=a(1042),v=a(577),d=a(7274),U=a(9521),s=a(4006),R=a(4859),h=a(7331),q=a(7392),k=a(4144),F=a(9549),O=a(4463);function Y(n,i){1&n&&(t.TgZ(0,"h1",14),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CONFIGURATION.FACTORIES.EDITOR.CREATE")))}function M(n,i){1&n&&(t.TgZ(0,"h1",14),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CONFIGURATION.FACTORIES.EDITOR.UPDATE")))}function D(n,i){1&n&&(t.TgZ(0,"h1",14),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CONFIGURATION.FACTORIES.EDITOR.DELETE")))}function Q(n,i){1&n&&(t.TgZ(0,"mat-error",15),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"FIELD_ERRORS.REQUIRED")," "))}const S=function(n){return{requiredLength:n}};function G(n,i){if(1&n&&(t.TgZ(0,"mat-error",15),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,"FIELD_ERRORS.REQUIRED_MINLENGTH",t.VKq(4,S,e.itemForm.get("shortName").errors.minlength.requiredLength))," ")}}function w(n,i){1&n&&(t.TgZ(0,"mat-error",15),t._uU(1," This field is required. "),t.qZA())}function H(n,i){if(1&n&&(t.TgZ(0,"mat-error",15),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" The minimum length for this field is ",e.itemForm.get("name").errors.minlength.requiredLength," characters. ")}}function K(n,i){1&n&&(t.TgZ(0,"mat-icon",18),t._uU(1,"cancel"),t.qZA())}function $(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"mat-chip-row",16),t.NdJ("removed",function(){const c=t.CHM(e).$implicit,f=t.oxw();return t.KtG(f.removeEmail(c.value))}),t._uU(1),t.YNc(2,K,2,0,"mat-icon",17),t.qZA()}if(2&n){const e=i.$implicit,o=t.oxw();t.Q6J("color",e?"warn":"")("removable",o.data.action!==o.EditorActions.Delete),t.xp6(1),t.hij(" ",e.value," "),t.xp6(1),t.Q6J("ngIf",o.removable)}}function P(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addOrUpdateItem(r.getFromFormGroup()))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("disabled",!e.itemForm.valid),t.xp6(1),t.Oqu(t.lcZ(2,2,"COMMON.CREATE"))}}function j(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addOrUpdateItem(r.getFromFormGroup()))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("disabled",!e.itemForm.valid),t.xp6(1),t.Oqu(t.lcZ(2,2,"COMMON.UPDATE"))}}function B(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.item.isActive=!0,t.KtG(r.addOrUpdateItem(r.item))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"COMMON.ACTIVATE")))}function X(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.deleteItem(r.getFromFormGroup()))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"COMMON.DELETE")))}class g{constructor(i,e,o,r){this.formBuiler=i,this.configurationService=e,this.dialogRef=o,this.data=r,this.EditorActions=l,this.separatorKeysCodes=[U.K5,U.OC],this.removable=!0,this.item=r.item,this.item.emails||(this.item.emails=[]),this.itemForm=this.formBuiler.group({_id:[this.item._id],_rev:[this.item._rev],isActive:[this.item.isActive],shortName:[this.item.shortName,[s.kI.required,s.kI.minLength(2)]],name:[this.item.name,[s.kI.required,s.kI.minLength(2)]],order:[this.item.order],address:[this.item.address],emails:this.formBuiler.array(this.item.emails.map(c=>[c]))}),this.itemForm.markAllAsTouched()}onNoClick(){this.dialogRef.close(!1)}getFromFormGroup(){return this.itemForm.getRawValue()}addOrUpdateItem(i){this.configurationService.addOrUpdateFactory(i).pipe((0,m.P)(),(0,u.b)(e=>this.dialogRef.close(!0))).subscribe()}deleteItem(i){i.isActive=!1,this.configurationService.addOrUpdateFactory(i).pipe((0,m.P)(),(0,u.b)(e=>this.dialogRef.close(!0))).subscribe()}get formEmails(){return this.itemForm.get("emails")}addEmail(i){console.log(i.value),i.value&&(this.validateEmail(i.value.trim())?(this.itemForm.get("emails").push(new s.NI(i.value.trim())),i.input&&(i.input.value="")):console.error("wrong email..."))}removeEmail(i){console.log("Removing "+i);let e=this.formEmails.value.indexOf(i);e>=0&&this.formEmails.removeAt(e)}validateEmail(i){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(i).toLowerCase())}static#t=this.\u0275fac=function(e){return new(e||g)(t.Y36(s.qu),t.Y36(v.eB),t.Y36(d.so),t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:g,selectors:[["app-editor"]],decls:37,vars:32,consts:[["mat-dialog-title","",4,"ngIf"],[1,"an-flex","an-flex-direction-column",3,"formGroup"],["appearance","fill"],["matInput","","formControlName","shortName",3,"readonly"],["class","text-danger",4,"ngIf"],["matInput","","formControlName","name",3,"readonly"],["matInput","","formControlName","address",3,"readonly"],["formArrayName","emails"],["chipList",""],["selected","","required","","name","chips",3,"color","removable","removed",4,"ngFor","ngForOf"],["placeholder","enter item ",3,"readonly","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","click",4,"ngIf"],["mat-button","","cdkFocusInitial","",3,"click",4,"ngIf"],["mat-dialog-title",""],[1,"text-danger"],["selected","","required","","name","chips",3,"color","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["mat-button","","cdkFocusInitial","",3,"disabled","click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(e,o){if(1&e&&(t.YNc(0,Y,3,3,"h1",0),t.YNc(1,M,3,3,"h1",0),t.YNc(2,D,3,3,"h1",0),t.TgZ(3,"mat-dialog-content")(4,"form",1)(5,"mat-form-field",2)(6,"mat-label"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._UZ(9,"input",3),t.YNc(10,Q,3,3,"mat-error",4),t.YNc(11,G,3,6,"mat-error",4),t.qZA(),t.TgZ(12,"mat-form-field",2)(13,"mat-label"),t._uU(14),t.ALo(15,"translate"),t.qZA(),t._UZ(16,"input",5),t.YNc(17,w,2,0,"mat-error",4),t.YNc(18,H,2,1,"mat-error",4),t.qZA(),t.TgZ(19,"mat-form-field",2)(20,"mat-label"),t._uU(21),t.ALo(22,"translate"),t.qZA(),t._UZ(23,"input",6),t.qZA(),t.TgZ(24,"mat-form-field",2)(25,"mat-chip-grid",7,8),t.YNc(27,$,3,4,"mat-chip-row",9),t.qZA(),t.TgZ(28,"input",10),t.NdJ("matChipInputTokenEnd",function(c){return o.addEmail(c)}),t.qZA()()()(),t.TgZ(29,"mat-dialog-actions")(30,"button",11),t.NdJ("click",function(){return o.onNoClick()}),t._uU(31),t.ALo(32,"translate"),t.qZA(),t.YNc(33,P,3,4,"button",12),t.YNc(34,j,3,4,"button",12),t.YNc(35,B,3,3,"button",13),t.YNc(36,X,3,3,"button",13),t.qZA()),2&e){const r=t.MAs(26);t.Q6J("ngIf",o.data.action===o.EditorActions.Create),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Update),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Delete),t.xp6(2),t.Q6J("formGroup",o.itemForm),t.xp6(3),t.Oqu(t.lcZ(8,24,"ITEM.FACTORY.SHORTNAME")),t.xp6(2),t.Q6J("readonly",o.data.action===o.EditorActions.Delete),t.xp6(1),t.Q6J("ngIf",null==o.itemForm.get("shortName").errors?null:o.itemForm.get("shortName").errors.required),t.xp6(1),t.Q6J("ngIf",null==o.itemForm.get("shortName").errors?null:o.itemForm.get("shortName").errors.minlength),t.xp6(3),t.Oqu(t.lcZ(15,26,"ITEM.FACTORY.NAME")),t.xp6(2),t.Q6J("readonly",o.data.action===o.EditorActions.Delete),t.xp6(1),t.Q6J("ngIf",o.itemForm.get("name").hasError("required")),t.xp6(1),t.Q6J("ngIf",o.itemForm.get("name").hasError("minlength")),t.xp6(3),t.Oqu(t.lcZ(22,28,"ITEM.FACTORY.ADDRESS")),t.xp6(2),t.Q6J("readonly",o.data.action===o.EditorActions.Delete),t.xp6(4),t.Q6J("ngForOf",o.formEmails.controls),t.xp6(1),t.Q6J("readonly",o.data.action===o.EditorActions.Delete)("matChipInputFor",r)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes)("matChipInputAddOnBlur",!0),t.xp6(3),t.Oqu(t.lcZ(32,30,"COMMON.CANCEL")),t.xp6(2),t.Q6J("ngIf",o.data.action===o.EditorActions.Create),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Update&&o.item.isActive),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Update&&!o.item.isActive),t.xp6(1),t.Q6J("ngIf",o.data.action===o.EditorActions.Delete)}},dependencies:[p.sg,p.O5,R.lW,h.RA,h.oH,h.qH,h.z3,d.uh,d.xY,d.H8,q.Hw,k.Nt,F.KE,F.hX,F.TO,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,s.CE,O.X$],styles:["mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}mat-dialog-actions[_ngcontent-%COMP%]{justify-content:end}"]})}var z=a(6709),W=a(4633);class A{transform(i,e){return e?i.filter(o=>!0===o.isActive):i}static#t=this.\u0275fac=function(e){return new(e||A)};static#e=this.\u0275pipe=t.Yjl({name:"hideNoActives",type:A,pure:!0})}function V(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(r){t.CHM(e);const c=t.oxw().$implicit,f=t.oxw();return t.KtG(f.deleteItem(r,c._id))}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}}function tt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",3),t.NdJ("click",function(){const c=t.CHM(e).$implicit,f=t.oxw();return t.KtG(f.updateItem(c._id))}),t.TgZ(1,"div",4)(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA()(),t.YNc(8,V,3,0,"button",5),t.qZA()}if(2&n){const e=i.$implicit;t.xp6(3),t.AsE("",e.shortName," -> ",e.name,""),t.xp6(2),t.Oqu(e.address),t.xp6(2),t.Oqu(e.emails?e.emails.join(", "):""),t.xp6(1),t.Q6J("ngIf",e.isActive)}}class _{constructor(i,e,o){this.logger=i,this.configurationService=e,this.dialog=o,this.loadFactoryWithNoActive=!1,this.items=[]}ngOnInit(){this.reloadFactories()}reloadFactories(){this.configurationService.getFactories(!0).pipe((0,u.b)(i=>this.items=i),(0,m.P)()).subscribe()}loadFactoryWithNoActiveChange(i){this.loadFactoryWithNoActive=i}displayEditor(i,e){return this.dialog.open(g,{width:"90%",data:{item:i,action:e}}).afterClosed().pipe((0,m.P)(),(0,u.b)(o=>this.logger.debug(`The dialog was closed with result ${o}, action ${e}`)),(0,u.b)(o=>{!0===o&&this.reloadFactories()}))}addItem(){this.displayEditor((()=>{let n={};return n._id=`factory_${J.Z()}`,n.isActive=!0,n.emails=[],n})(),l.Create).subscribe({next:i=>{},error:i=>{}})}updateItem(i){this.configurationService.getFactory(i).pipe((0,m.P)(),(0,y.z)(o=>this.displayEditor(o,l.Update))).subscribe({next:o=>{},error:o=>{}})}deleteItem(i,e){i.stopPropagation(),console.log("delete factory"),this.configurationService.getFactory(e).pipe((0,m.P)(),(0,y.z)(r=>this.displayEditor(r,l.Delete))).subscribe({next:r=>{},error:r=>{}})}static#t=this.\u0275fac=function(e){return new(e||_)(t.Y36(v.Yd),t.Y36(v.eB),t.Y36(d.uw))};static#e=this.\u0275cmp=t.Xpm({type:_,selectors:[["app-factories"]],decls:11,vars:8,consts:[[3,"checked","change"],["class","an-list-item",3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","primary",1,"mat-fab-bottom-right",3,"click"],[1,"an-list-item",3,"click"],[1,"an-list-item-des"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div")(1,"div")(2,"mat-checkbox",0),t.NdJ("change",function(c){return o.loadFactoryWithNoActiveChange(c.checked)}),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"mat-list"),t.YNc(6,tt,9,5,"div",1),t.ALo(7,"hideNoActives"),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return o.addItem()}),t.TgZ(9,"mat-icon"),t._uU(10,"add"),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("checked",o.loadFactoryWithNoActive),t.xp6(1),t.hij(" ",t.lcZ(4,3,"CONFIGURATION.FACTORIES.LOAD_NOACTIVE")," "),t.xp6(3),t.Q6J("ngForOf",t.xi3(7,5,o.items,!o.loadFactoryWithNoActive)))},dependencies:[p.sg,p.O5,R.cs,z.oG,q.Hw,W.i$,O.X$,A]})}class T{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(e){return new(e||T)};static#e=this.\u0275cmp=t.Xpm({type:T,selectors:[["app-checklist"]],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"checklist works!"),t.qZA())}})}class C{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(e){return new(e||C)};static#e=this.\u0275cmp=t.Xpm({type:C,selectors:[["app-delivery"]],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"delivery works!"),t.qZA())}})}class E{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(e){return new(e||E)};static#e=this.\u0275cmp=t.Xpm({type:E,selectors:[["app-configuration"]],decls:13,vars:12,consts:[[3,"label"]],template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"mat-tab-group")(4,"mat-tab",0),t.ALo(5,"translate"),t._UZ(6,"app-factories"),t.qZA(),t.TgZ(7,"mat-tab",0),t.ALo(8,"translate"),t._UZ(9,"app-checklist"),t.qZA(),t.TgZ(10,"mat-tab",0),t.ALo(11,"translate"),t._UZ(12,"app-delivery"),t.qZA()()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,4,"CONFIGURATION.TITLE")),t.xp6(3),t.s9C("label",t.lcZ(5,6,"CONFIGURATION.FACTORIES.TITLE")),t.xp6(3),t.s9C("label",t.lcZ(8,8,"CONFIGURATION.CHECKLIST.TITLE")),t.xp6(3),t.s9C("label",t.lcZ(11,10,"CONFIGURATION.DELIVERY.TITLE")))},dependencies:[b.uX,b.SP,_,T,C,O.X$]})}const et=[{path:"",component:E}];class I{static#t=this.\u0275fac=function(e){return new(e||I)};static#e=this.\u0275mod=t.oAB({type:I});static#o=this.\u0275inj=t.cJS({imports:[x.Bz.forChild(et),x.Bz]})}var ot=a(7654);class Z{static#t=this.\u0275fac=function(e){return new(e||Z)};static#e=this.\u0275mod=t.oAB({type:Z});static#o=this.\u0275inj=t.cJS({imports:[p.ez,I,ot.m]})}}}]);